{% extends "shared/base.html" %}
{% block title %}
    <title>Game view</title>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h5 class="mt-4 p-3 display-5">Game on {{ game.date }}</h5>

    <!-- Header row -->
    <ul class="list-group list-group-flush">
        <li class="list-group-item d-flex justify-content-between fw-bold">
            <span>Player</span>
            <span>Money In</span>
            {% if is_add_on_requests %}
                <span>Requests</span>
            {% endif %}
        </li>

        <!-- Display game info -->
        {% for info in players_info %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>{{ info.player.nick }}</span>

                <!-- Money In -->
                <span>
                    {% if info.money_in % 1 %}
                        {{ "%.2f"|format(info.money_in) }}
                    {% else %}
                        {{ info.money_in|int }}
                    {% endif %}
                </span>

                {% if is_add_on_requests %}
                    <!-- Requests Column -->
                    <span>
                        {% if info.add_on_requests %}
                            {% for addon in info.add_on_requests %}
                                {{ addon.amount }}{% if not loop.last %}, {% endif %}
                            {% endfor %}
                        {% else %}
                            -
                        {% endif %}
                    </span>
                {% endif %}
            </li>
        {% endfor %}
    </ul>

    <!-- Action buttons -->
    <div class="d-flex justify-content-between mt-3">
        <!-- Back button -->
        <a href="/" class="btn btn-outline-secondary">Back</a>

        <!-- Request chips button (only if game is running) -->
        {% if game.running %}
            <form method="POST" action="/game/{{ game.id }}/add_on">
                <button type="submit" class="btn btn-primary">Request Chips</button>
            </form>
        {% endif %}
    </div>
</div>
{% endblock %}