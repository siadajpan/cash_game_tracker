<!-- Header -->
<ul class="list-group list-group-flush">
    <li class="list-group-item">
        <div class="row fw-bold text-center">
            <div class="col-3 text-start">Player</div>
            <div class="col-2">Money In</div>
            {% if requests %}
                <div class="col-4">Requests</div>
                <div class="col-3">Actions</div>
            {% endif %}
        </div>
    </li>

    <!-- Players -->
    {% for info in players_info %}
        <li class="list-group-item">
            <div class="row text-center align-items-center">
                <div class="col-3 text-start">{{ info.player.nick }}</div>

                <div class="col-2">
                    {% if info.money_in % 1 %}
                        {{ "%.2f"|format(info.money_in) }}
                    {% else %}
                        {{ info.money_in|int }}
                    {% endif %}
                </div>

                {% if requests %}
                    <!-- Requests Column -->
                    <div class="col-4">
                        {% if info.add_on_request %}
                             Add-on: {{ info.add_on_request.amount }}
                        {% elif info.cash_out_request %}
                            Cash-out: {{ info.cash_out_request.amount }}
                        {% endif %}
                    </div>
                    <!-- Actions Column -->
                    <div class="col-3 d-flex justify-content-center align-items-center gap-2">
                        {% for req_type in ['add_on_request', 'cash_out_request'] %}
                            {% set req = info[req_type] %}
                            {% if req %}
                                {% set req_prefix = "_".join(req_type.split('_')[:2]) %}

                                <!-- Decline -->
                                <form method="POST" action="/game/{{ game.id }}/{{ req_prefix }}/{{ req.id }}/decline" class="d-inline">
                                    <button type="submit" class="btn btn-danger btn-sm px-3 py-1">
                                        <i class="bi bi-x-lg"></i>
                                    </button>
                                </form>
                                <!-- Approve -->
                                <form method="POST" action="/game/{{ game.id }}/{{ req_prefix }}/{{ req.id }}/approve" class="d-inline">
                                    <button type="submit" class="btn btn-success btn-sm px-3 py-1">
                                        <i class="bi bi-check-lg"></i>
                                    </button>
                                </form>
                            {% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </li>

    {% endfor %}
</ul>


<!-- Footer Buttons -->
<div class="d-flex justify-content-between mt-3">
    <a href="/" class="btn btn-outline-secondary">Back</a>

    {% if game.running %}
        <a href="/game/{{ game.id }}/finish" class="btn btn-primary">Finish game</a>
        <a href="/game/{{ game.id }}/cash_out" class="btn btn-primary">Cash out</a>
        <a href="/game/{{ game.id }}/add_on" class="btn btn-primary">Request chips</a>
    {% endif %}
</div>